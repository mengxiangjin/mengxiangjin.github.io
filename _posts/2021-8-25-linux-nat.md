---
layout: post
title: Only-Host、桥接、NAT模式
categories: Linux
description: 虚拟机下网络模式
keywords: 虚拟机, NAT, 桥接
---

从今天开始，跟着韩顺平老师学习Linux，特此记录下在学习过程中遇到的知识点以及问题，以便以后可以得到更好的巩固与复习。

## 知识点

在Vmware上安装Linux镜像文件的时候，选项网络模式的选择，如下所示：![](/images/jin/linux/nat.png)

我们最常配置的便是NAT模式，其余还有桥接，Only-Host。

## 桥接

桥接模式，顾名思义，虚拟机同主机之间通过‘’‘桥’网络通信。设置为桥接模式时，Vmware会虚拟出来一块网卡和真正的网卡进行桥接，这样就致使连通起来，发到虚拟机上数据会通过该桥进行正确到达，而由虚拟机发出的数据包也会发送到同一网段下的其他主机。

类似于虚拟机与主机是同一局域网下的二台电脑（网段相同），虚拟机可与同一局域网下的其他主机进行相互通信。但是可能会造成IP冲突。如图：![](/images/jin/linux/Snipaste_2021-08-25_21-23-06.png)

主机与主机，主机与虚拟机之间是互相连通的，但是一旦同一局域网下的主机用户多了，造成IP冲突。倘若有200个学生，每个学生都装入一台虚拟机，总共400台机器，则在192.182.2.0此网段下容纳不了这么多机器，造成IP冲突。

## NAT模式

NAT（网络地址转换协议），其实可以每一台主机都分配一个全球唯一的IP地址进行通信，可随着主机数目的越来越多，IP地址数量也会慢慢不足。这时，NAT协议就发挥作用了，它实则是一个NAT路由器，NAT路由器会将同一局域网下的数据发送IP地（192.168.2.99）首先进行转换为全球唯一的IP地址，这时才可以同外部进行通信，这样只要在同一局域网下，由一个IP地址即可解决供应不足的问题。

NAT路由器内部维护着一张NAT路由表，可提供端口对端口之间的转换，如同所示：![](/images/jin/linux/Snipaste_2021-08-25_21-45-37.png)

NAT模式即主机与虚拟机可以不在同一个网段下，虚拟机通过DHCP主动分配IP地址，当虚拟机发送数据包时，此时，虚拟机内部虚拟网卡与主机在同一网段，数据包经过NAT转换可到达主机或者其他主机。主机与虚拟机可以相互ping通，但是其他主机数据包不可达虚拟机，如图：![](/images/jin/linux/Snipaste_2021-08-25_21-57-30.png)

## Only-Host

私有网络共享主机，只是提供主机与虚拟机之间进行互访，一般用于不允许虚拟机访问互联网情景。

